<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
    <title>WatchAllFree</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .card {
            border-radius: 1rem;
        }
        .card-header {
            background-color: #007bff;
            color: white;
            border-top-left-radius: 1rem;
            border-top-right-radius: 1rem;
        }
        .btn-primary {
            background-color: #007bff;
            border: none;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .accordion-button:not(.collapsed) {
            background-color: #007bff;
            color: white;
        }
        .accordion-button {
            color: #007bff;
        }
        h1, h2 {
            color: #343a40;
        }
        iframe {
            border: 1px solid #ddd;
            border-radius: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .search-result-card {
            transition: transform 0.2s;
        }
        .search-result-card:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>

<body class="p-3">
    <div class="text-center mb-4">
        <h1 class="fw-bold fst-italic">Wanna watch a movie or a TV show?</h1>
        <h2 class="fst-italic">You've come to the right place!</h2>
    </div>

    <div class="container card p-4 mb-3 shadow-sm">
        <form method="get" class="d-flex flex-column align-items-center" onsubmit="event.preventDefault(); get_iframe(); return false;">
            <input type="text" id="id" placeholder="IMDb ID (e.g. tt1553656)" class="form-control mb-2" style="max-width: 400px;" required>
            <input type="number" id="season" placeholder="Season Number (e.g. 1)" class="form-control mb-2" style="max-width: 400px;">
            <input type="number" id="episode" placeholder="Episode Number (e.g. 1)" class="form-control mb-3" style="max-width: 400px;">
            <button type="submit" class="btn btn-primary">Submit</button>
        </form>
        <p class="text-info mt-3">If you want to watch a movie, leave the "Season Number" and "Episode Number" fields empty.</p>
    </div>

    <div class="accordion mb-3" id="accordionExample">
        <div class="accordion-item">
            <h2 class="accordion-header">
                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#search-accordion" aria-expanded="true" aria-controls="search-accordion">
                    Search By Title
                </button>
            </h2>
            <div id="search-accordion" class="accordion-collapse collapse show" aria-expanded="true">
                <div class="accordion-body">
                    <form method="get" onsubmit="event.preventDefault(); search(); return false;" class="d-flex">
                        <input type="text" id="q_field" placeholder="e.g. John Wick" class="form-control me-2" oninput="search();">
                        <button type="submit" class="btn btn-primary">Search</button>
                    </form>
                    <div id="search-results" class="mt-3 d-flex flex-wrap"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-center p-3" style="width: 100%;">
        <iframe src="" width="1200px" height="600px" allowfullscreen></iframe>
    </div>

    <div class="card container-flex mb-3 p-3 shadow-sm">
        <div class="d-flex justify-content-between mb-2">
            <h3>Watch History</h3>
            <button type="button" class="btn btn-sm btn-outline-secondary" onclick="clear_history();">
                <i class="bi bi-trash3"></i> Clear History
            </button>
        </div>
        <table id="watched" class="table">
            <thead>
                <tr>
                    <th scope="col">ID</th>
                    <th scope="col">Title</th>
                    <th scope="col">Season</th>
                    <th scope="col">Episode</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js" integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS" crossorigin="anonymous"></script>

    <script>
        // JavaScript functions as before, with slight modifications to add class 'search-result-card'
        function add_result(item) {
            const results = document.querySelector("#search-results");

            if (results.innerHTML === "No results matching your query!") {
                results.innerHTML = "";
            }

            const card = document.createElement("div");
            card.classList.add("card", "search-result-card", "m-3", "p-3");
            card.style.width = "calc(33.333% - 2rem)"; // Responsive card width

            const card_body = document.createElement("div");
            card_body.classList.add("card-body");

            const card_image = document.createElement("img");
            card_image.src = item.i;
            card_image.height = "150";
            card_image.width = "150";

            const card_title = document.createElement("h5");
            card_title.classList.add("card-title");
            card_title.innerHTML = item.l + ` (${item.y})`;

            const card_type = document.createElement("h6");
            card_type.classList.add("card-title-secondary");
            card_type.innerHTML = item.q === "feature" ? "Movie" : item.q;

            const card_text = document.createElement("p");
            card_text.classList.add("card-text");
            card_text.innerHTML = item.s;

            const card_id = document.createElement("p");
            card_id.classList.add("card-link");
            card_id.innerHTML = `IMDb ID: ${item.id}`;

            card.appendChild(card_image);
            card_body.appendChild(card_title);
            card_body.appendChild(card_type);
            card_body.appendChild(card_text);
            card_body.appendChild(card_id);

            card.appendChild(card_body);

            card.addEventListener("click", function () {
                document.querySelector("#id").value = item.id;
                window.scrollTo(0, 0);
            });

            results.appendChild(card);
        }
    </script>
</body>

</html>
